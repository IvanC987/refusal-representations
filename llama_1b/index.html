
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../qwen/">
      
      
        <link rel="next" href="../refusal_across_models/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>LLaMA-3.2-1B-Instruct - Refusal Directions in Instruction-Tuned Models</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#refusal-representation-in-llama-32-1b-instruct" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Refusal Directions in Instruction-Tuned Models" class="md-header__button md-logo" aria-label="Refusal Directions in Instruction-Tuned Models" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Refusal Directions in Instruction-Tuned Models
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              LLaMA-3.2-1B-Instruct
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Refusal Directions in Instruction-Tuned Models" class="md-nav__button md-logo" aria-label="Refusal Directions in Instruction-Tuned Models" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Refusal Directions in Instruction-Tuned Models
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../qwen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen-1.8B-Chat
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    LLaMA-3.2-1B-Instruct
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    LLaMA-3.2-1B-Instruct
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experimental-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refusal-vector-strength-across-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Refusal vector strength across layers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-layer-structure-of-refusal" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-layer structure of refusal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qualitative-behavior-and-a-two-tier-refusal-hypothesis" class="md-nav__link">
    <span class="md-ellipsis">
      Qualitative behavior and a two-tier refusal hypothesis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targeting-tier-2-refusal" class="md-nav__link">
    <span class="md-ellipsis">
      Targeting tier-2 refusal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subspace-hypothesis-and-runtime-ablation" class="md-nav__link">
    <span class="md-ellipsis">
      Subspace hypothesis and runtime ablation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offline-weight-orthogonalization" class="md-nav__link">
    <span class="md-ellipsis">
      Offline weight orthogonalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../refusal_across_models/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Refusal Across Models
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experimental-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Experimental setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refusal-vector-strength-across-layers" class="md-nav__link">
    <span class="md-ellipsis">
      Refusal vector strength across layers
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-layer-structure-of-refusal" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-layer structure of refusal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#qualitative-behavior-and-a-two-tier-refusal-hypothesis" class="md-nav__link">
    <span class="md-ellipsis">
      Qualitative behavior and a two-tier refusal hypothesis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#targeting-tier-2-refusal" class="md-nav__link">
    <span class="md-ellipsis">
      Targeting tier-2 refusal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subspace-hypothesis-and-runtime-ablation" class="md-nav__link">
    <span class="md-ellipsis">
      Subspace hypothesis and runtime ablation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#offline-weight-orthogonalization" class="md-nav__link">
    <span class="md-ellipsis">
      Offline weight orthogonalization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="refusal-representation-in-llama-32-1b-instruct">Refusal Representation in LLaMA-3.2-1B-Instruct<a class="headerlink" href="#refusal-representation-in-llama-32-1b-instruct" title="Permanent link">&para;</a></h1>
<p>This section applies the same methodology used for Qwen-1.8B-Chat to the <code>LLaMA-3.2-1B-Instruct</code> model. The goal here is not to rediscover whether refusal directions exist (they clearly do), but to test whether the <em>single-direction</em> story that worked cleanly for Qwen still holds.</p>
<p>Short answer: it doesn’t. While LLaMA-1B exhibits strong refusal-aligned directions at individual layers, removing any single one only weakens refusal rather than disabling it. The evidence below points to refusal being distributed across a low-rank subspace rather than concentrated along a single axis.</p>
<hr />
<h2 id="experimental-setup">Experimental setup<a class="headerlink" href="#experimental-setup" title="Permanent link">&para;</a></h2>
<p>The setup closely mirrors the Qwen experiments, with one adjustment: all refusal vectors (RVs) are extracted <strong>sequentially</strong>, processing prompts one at a time. Based on the Qwen results, this avoids unnecessary noise from batching and padding.</p>
<p>As before, RVs are extracted using paired harmful vs safe prompts to minimize semantic confounds. Each harmful prompt has a minimally edited safe counterpart that preserves structure and technical detail, differing primarily in intent.</p>
<p>For example:</p>
<p><strong>Harmful</strong></p>
<p>“How can I smuggle prohibited items through airport security without getting caught?”</p>
<p><strong>Safe</strong></p>
<p>“How can airport security detect prohibited items during screening?”</p>
<p>This pairing strategy is meant to isolate refusal intent rather than topic semantics.</p>
<hr />
<h2 id="refusal-vector-strength-across-layers">Refusal vector strength across layers<a class="headerlink" href="#refusal-vector-strength-across-layers" title="Permanent link">&para;</a></h2>
<p>As in the Qwen analysis, I measured how well each layer’s refusal vector separates harmful from safe prompts using Cohen’s d. The values are large and nearly monotonic across mid-late layers:</p>
<div class="highlight"><pre><span></span><code>k=15, v=6.84
k=13, v=6.76
k=14, v=6.58
k=11, v=6.50
k=12, v=6.49
k=10, v=6.38
k=9,  v=6.05
k=8,  v=4.64
...
</code></pre></div>
<p>This indicates strong linear separability at individual layers. However, high separability here doesn't imply that refusal can be globally controlled by intervening on any single direction.</p>
<hr />
<h2 id="cross-layer-structure-of-refusal">Cross-layer structure of refusal<a class="headerlink" href="#cross-layer-structure-of-refusal" title="Permanent link">&para;</a></h2>
<p>To understand how refusal directions relate across layers, I computed layer-wise cosine similarity between sequentially extracted RVs.</p>
<div align="center">
  <img src="images/llama_1b_heatmap.png" alt="Sequential RV cosine similarity heatmap" width="50%">
</div>

<p>Unlike Qwen, refusal vectors in LLaMA-1B do not collapse into a single stable direction in mid-late layers. Strong alignment is limited to nearby layers, and cosine similarity decays rapidly away from the diagonal. Each layer encodes refusal in a slightly different direction.</p>
<p>This structure looks less like a single axis and more like a low-rank subspace where refusal is linearly accessible everywhere, but no single direction generalizes globally across the network.</p>
<p>To test that, I applied each layer’s refusal vector across all layers during generation with a fixed intervention strength:</p>
<div class="arithmatex">\[
r \leftarrow r - \alpha \langle r, v_l \rangle v_l, \quad \alpha = 1.0
\]</div>
<p>Responses to 100 harmful prompts were scored by an external LLM judge along two axes:</p>
<ul>
<li><strong>Compliance</strong> ∈ {0.0, 0.5, 1.0}</li>
<li><strong>Coherence</strong> ∈ {0.0, 0.5, 1.0}</li>
</ul>
<p>The aggregate results are summarized below:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Layer</th>
<th style="text-align: right;">Mean compliance</th>
<th style="text-align: right;">Mean coherence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">0.955</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">0.975</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.974</td>
</tr>
<tr>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.985</td>
</tr>
<tr>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.940</td>
</tr>
<tr>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.110</td>
<td style="text-align: right;">0.935</td>
</tr>
</tbody>
</table>
<p>Coherence degradation is minute, but compliance settled at a very low score. Even the most effective layer (layer 9) only reaches about 21% compliance, meaning nearly 80% of harmful prompts are still refused. This sharply contrasts with Qwen, where comparable interventions typically exceeds 80-90% compliance.</p>
<hr />
<h2 id="qualitative-behavior-and-a-two-tier-refusal-hypothesis">Qualitative behavior and a two-tier refusal hypothesis<a class="headerlink" href="#qualitative-behavior-and-a-two-tier-refusal-hypothesis" title="Permanent link">&para;</a></h2>
<p>Inspecting raw generations reveals a consistent pattern:</p>
<ul>
<li>Mildly illegal requests (e.g. theft, evasion) are sometimes answered</li>
<li>Severe requests (e.g. murder, explosives) are often still refused</li>
<li>Many responses include warnings, disclaimers, or partial refusals mixed with guidance</li>
</ul>
<p>For example, a layer-9 ablation often yields responses of the form:</p>
<blockquote>
<p>“I can provide general information… I do not condone or encourage…”</p>
</blockquote>
<p>followed by actionable steps.</p>
<p>These observations led me to believe that a <strong>two-tier refusal structure</strong> exists:</p>
<ul>
<li><strong>Tier-1 refusal</strong> captures surface-level safety behavior (polite refusals, disclaimers, partial redirection). This tier is linearly accessible and substantially weakened by residual stream ablation.</li>
<li><strong>Tier-2 refusal</strong> enforces higher-order safety constraints that categorically block extreme harms (e.g. murder, terrorism). These constraints persist even after linear or subspace removal and likely rely on more distributed or non-linear mechanisms such as intent classification and response templating.</li>
</ul>
<hr />
<h2 id="targeting-tier-2-refusal">Targeting tier-2 refusal<a class="headerlink" href="#targeting-tier-2-refusal" title="Permanent link">&para;</a></h2>
<p>If refusal really has two tiers, a natural question is whether the extraction dataset itself is part of the problem. The original harmful/safe pairs include many moderately harmful cases (theft, evasion). To probe deeper constraints, I constructed a new dataset focused on more extreme harms (e.g. murder, terrorism) and repeated the extraction and runtime ablation.</p>
<p>The aggregate results for this tier-2-focused dataset are:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Layer</th>
<th style="text-align: right;">Mean compliance</th>
<th style="text-align: right;">Mean coherence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.265</td>
<td style="text-align: right;">0.960</td>
</tr>
<tr>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.124</td>
<td style="text-align: right;">0.964</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.125</td>
<td style="text-align: right;">0.985</td>
</tr>
<tr>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.130</td>
<td style="text-align: right;">0.970</td>
</tr>
<tr>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.930</td>
</tr>
<tr>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.935</td>
</tr>
</tbody>
</table>
<p>Compliance improves modestly for some layers (most notably layer 9), but slightly decrease for others. Cosine similarity across layers remains high and largely unchanged, indicating that even extreme prompts do not fully isolate the deeper safety constraints. Overall gains are small and may fall within evaluation noise given the limited sample size and non-determinism of LLM-based judging.</p>
<hr />
<h2 id="subspace-hypothesis-and-runtime-ablation">Subspace hypothesis and runtime ablation<a class="headerlink" href="#subspace-hypothesis-and-runtime-ablation" title="Permanent link">&para;</a></h2>
<p>Given that:</p>
<ul>
<li>Multiple adjacent layers have strong but imperfect refusal vectors</li>
<li>Single-vector ablation plateaus at low compliance</li>
<li>Coherence remains high across layers</li>
</ul>
<p>it makes sense to treat refusal in LLaMA-1B as occupying a <strong>low-dimensional subspace</strong> rather than a single direction.</p>
<p>I selected several high-performing layers (from 7-10), stacked their RVs, and computed an orthonormal basis using QR decomposition:</p>
<div class="arithmatex">\[
V = [v_{l_1}, v_{l_2}, \dots, v_{l_k}], \quad Q = \mathrm{QR}(V)
\]</div>
<p>Runtime removal of this subspace does improve compliance (to around 36%) compared to any single-vector intervention while largely preserving coherence.</p>
<p>That said, even with subspace ablation compliance is nowhere near Qwen's level and the refusal-performance trade-off is substantially steeper as <span class="arithmatex">\(\alpha\)</span> increases.</p>
<p>Further stacking layers (13-15) on top of existing ones proved to be minimally helpful, where compliance increases by a small amount (might even be due to noise). </p>
<hr />
<h2 id="offline-weight-orthogonalization">Offline weight orthogonalization<a class="headerlink" href="#offline-weight-orthogonalization" title="Permanent link">&para;</a></h2>
<p>To enable benchmarking, I performed offline ablation by orthogonalizing model weights with respect to the refusal subspace. Both the attention output projections <span class="arithmatex">\(W_O\)</span> and MLP output projections <span class="arithmatex">\(W_{out}\)</span> were modified to remove components aligned with the subspace:</p>
<div class="arithmatex">\[
W \leftarrow W - \alpha W Q Q^T
\]</div>
<p>Multiple values of <span class="arithmatex">\(\alpha\)</span> were tested:</p>
<ul>
<li><strong><span class="arithmatex">\(\alpha\)</span> = 0.5</strong>: minimal capability loss, limited refusal removal</li>
<li><strong><span class="arithmatex">\(\alpha\)</span> = 1.0</strong>: best trade-off between compliance and performance</li>
<li><strong><span class="arithmatex">\(\alpha\)</span> = 1.5</strong>: stronger refusal suppression with noticeable degradation on benchmarks</li>
</ul>
<p>Overall performance remains slightly below baseline, but does not collapse.</p>
<hr />
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>Refusal in LLaMA-3.2-1B-Instruct is significantly more distributed than in Qwen-1.8B-Chat. While it is linearly accessible at individual layers, no single direction suffices for global control. Subspace-based interventions improve compliance but still fall short, especially for extreme harms.</p>
<p>The picture that emerges is that linear mechanisms capture the <em>first line</em> of refusal behavior, while deeper safety constraints persist beyond what residual-stream subspace removal can reach. The next section applies the same experiment to more models, including LLaMA-3.1-8B-Instruct, where it returns back to a largely single-direction refusal vector.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.math"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>