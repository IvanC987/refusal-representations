
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../llama_1b/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Refusal Across Models - Refusal Directions in Instruction-Tuned Models</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#refusal-structure-across-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Refusal Directions in Instruction-Tuned Models" class="md-header__button md-logo" aria-label="Refusal Directions in Instruction-Tuned Models" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Refusal Directions in Instruction-Tuned Models
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Refusal Across Models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Refusal Directions in Instruction-Tuned Models" class="md-nav__button md-logo" aria-label="Refusal Directions in Instruction-Tuned Models" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Refusal Directions in Instruction-Tuned Models
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../qwen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Qwen-1.8B-Chat
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../llama_1b/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LLaMA-3.2-1B-Instruct
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Refusal Across Models
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Refusal Across Models
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#llama-31-8b-instruct" class="md-nav__link">
    <span class="md-ellipsis">
      LLaMA-3.1-8B-Instruct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-llama-1b-vs-llama-8b" class="md-nav__link">
    <span class="md-ellipsis">
      Interpreting LLaMA-1B vs LLaMA-8B
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-model-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-model comparison
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#llama-31-8b-instruct" class="md-nav__link">
    <span class="md-ellipsis">
      LLaMA-3.1-8B-Instruct
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interpreting-llama-1b-vs-llama-8b" class="md-nav__link">
    <span class="md-ellipsis">
      Interpreting LLaMA-1B vs LLaMA-8B
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cross-model-comparison" class="md-nav__link">
    <span class="md-ellipsis">
      Cross-model comparison
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="refusal-structure-across-models">Refusal Structure Across Models<a class="headerlink" href="#refusal-structure-across-models" title="Permanent link">&para;</a></h1>
<p>After digging into Qwen-1.8B-Chat and LLaMA-3.2-1B-Instruct in detail, the next obvious question is whether either of those behaviors is typical. In particular: is LLaMA-1B just a weird outlier, or are there genuinely two different "modes" of how refusal is implemented across models?</p>
<p>From the models I’ve tested so far, it looks like the latter. Some models implement refusal in a way that collapses cleanly onto a single dominant direction, while others spread refusal across a low-rank subspace.</p>
<p>When moving up to <strong>LLaMA-3.1-8B-Instruct</strong>, refusal behavior snaps back to looking much more like Qwen than LLaMA-1B. A single refusal direction is again mostly sufficient to control behavior, though the details are a bit more nuanced.</p>
<hr />
<h2 id="llama-31-8b-instruct">LLaMA-3.1-8B-Instruct<a class="headerlink" href="#llama-31-8b-instruct" title="Permanent link">&para;</a></h2>
<p>The layer-wise cosine similarity heatmap for LLaMA-3.1-8B-Instruct is shown below.</p>
<div align="center">
  <img src="images/llama_8b_heatmap.png" alt="Sequential RV cosine similarity heatmap" width="50%">
</div>

<p>At a glance, this looks very similar to Qwen. A large block of highly similar refusal vectors appears in the later part of the network, indicating that refusal representations converge and remain stable across many layers. This is very different from LLaMA-1B, where similarity drops off quickly away from the diagonal.</p>
<p>However, when looking at <em>behavioral impact</em>, the strongest refusal vectors do <strong>not</strong> come from the very last layers. Instead, the most effective vectors show up earlier:</p>
<table>
<thead>
<tr>
<th style="text-align: right;">Layer</th>
<th style="text-align: right;">Mean compliance</th>
<th style="text-align: right;">Mean coherence</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0.795</td>
<td style="text-align: right;">0.965</td>
</tr>
<tr>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0.570</td>
<td style="text-align: right;">0.970</td>
</tr>
<tr>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.950</td>
</tr>
<tr>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">0.940</td>
</tr>
<tr>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.100</td>
<td style="text-align: right;">0.950</td>
</tr>
</tbody>
</table>
<p>Despite the model having 32 layers, the peak leverage sits around layers 8-11. This is earlier than the “mid-late” region observed in Qwen and earlier than I initially expected based on the smaller LLaMA models.</p>
<p>My personal interpretation of the heatmap is that because layers roughly 15 and onward show extremely high cosine similarity with one another, the refusal direction has likely already been decided earlier and is simply being reused or lightly refined at this point. These later layers encode a <em>stable</em> refusal representation, but intervening on them has relatively weak causal impact. By contrast, layers near 9 appear to be where refusal is first decisively introduced.</p>
<p>Put differently: cosine similarity here reflects <em>stability</em>, not <em>decision power</em>. LLaMA-8B seems to decide on refusal early, then propagate that decision forward through many nearly identical layers. That appears to be why when model's has roughly a single refusal direction the cross-layer cosine similarity is high. The overall direction has been decided and later layers are merely refining it stylisically. For those that lives on a low rank subspace, there isn't a single, well defined direction and hence the heatmaps of those models usually wouldn't have a high cosine similarity for the late layers. </p>
<hr />
<h2 id="interpreting-llama-1b-vs-llama-8b">Interpreting LLaMA-1B vs LLaMA-8B<a class="headerlink" href="#interpreting-llama-1b-vs-llama-8b" title="Permanent link">&para;</a></h2>
<p>This contrast sharpens what’s going on in LLaMA-1B. In that model, refusal vectors never really collapse to a single stable direction. Each layer contributes a slightly different refusal-aligned component, producing a low-rank structure rather than a single axis. No single layer dominates, and refusal remains distributed across the network.</p>
<p>LLaMA-8B, by comparison, behaves much more like Qwen:</p>
<ul>
<li>refusal becomes well-defined early</li>
<li>a single direction is largely sufficient for control</li>
<li>later layers mostly propagate an already-decided signal</li>
</ul>
<p>One plausible explanation is that LLaMA-1B’s distributed refusal is a consequence of training choices or architectural scale effects, rather than something fundamental about the LLaMA family. Supporting this, LLaMA-3.2-3B-Instruct behaves more like the 1B model than the 8B model, with peak compliance stuck around ~15% under single-direction ablation.</p>
<hr />
<h2 id="cross-model-comparison">Cross-model comparison<a class="headerlink" href="#cross-model-comparison" title="Permanent link">&para;</a></h2>
<p>To put these results in context, I tested a small collection of other instruction-tuned models using the same basic methodology. Due to limited compute, all of these models are under ~10B parameters; extracting refusal vectors and generating large numbers of rollouts per layer gets expensive quickly. The table below summarizes whether a single refusal vector was sufficient, along with peak compliance achieved under runtime ablation.</p>
<table>
<thead>
<tr>
<th>Model</th>
<th>Single RV sufficient?</th>
<th>Peak compliance</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>Qwen3-1.7B</td>
<td>Yes</td>
<td>~96%</td>
<td>Very strong single dir</td>
</tr>
<tr>
<td>Qwen-1.8B</td>
<td>Yes</td>
<td>~90%</td>
<td>Clean baseline</td>
</tr>
<tr>
<td>gemma-2b-it</td>
<td>Yes</td>
<td>~90%</td>
<td>Matches AF post</td>
</tr>
<tr>
<td>LLaMA-3.1-8B-Instruct</td>
<td>Yes</td>
<td>~80%</td>
<td>Early decision, stable</td>
</tr>
<tr>
<td>phi-3-mini-4k-instruct</td>
<td>Partial</td>
<td>~39%</td>
<td>Mixed behavior</td>
</tr>
<tr>
<td>LLaMA-3.2-1B-Instruct</td>
<td>No</td>
<td>~21%</td>
<td>Low-rank subspace</td>
</tr>
<tr>
<td>LLaMA-3.2-3B-Instruct</td>
<td>No</td>
<td>~15%</td>
<td>Similar to 1B</td>
</tr>
</tbody>
</table>
<p>A few patterns stand out:</p>
<ul>
<li>Several models (Qwen, Gemma, LLaMA-8B) admit a clean single-direction refusal representation.</li>
<li>LLaMA 1B and 3B variants behave differently, with refusal spread across a low-dimensional subspace.</li>
<li>Phi lands in between, where single-direction ablation helps but clearly does not saturate compliance.</li>
</ul>
<p>Overall, refusal structure is not universal across instruction-tuned models. Some models make an early, fairly discrete refusal decision that is then propagated forward, making them highly vulnerable to single-direction interventions. Others distribute refusal across layers, which makes it harder to remove cleanly and leaves deeper safety constraints intact even after subspace-level ablation.</p>
<p>Because these experiments focus on relatively small models (all under ~10B parameters), it’s still unclear how well this picture carries over to much larger systems. That said, the consistency across several families hints that scale and training choices both matter. Understanding <em>when</em> refusal collapses to a single direction, and <em>why</em>, feels like a key open question going forward.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.math"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>